<a *ngIf="pageAsDemo" href="https://github.com/nie-ine/NIE-OS.git" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

<app-load-variables
  (sendPageBack)="receivePage( $event )"
  (sendOpenAppsInThisPageBack)="receiveOpenAppsInThisPage( $event )"
  [reload]="reloadVariables">

</app-load-variables>

  <app-data-assignment
    [index]="index"
    [openAppsInThisPage]="openAppsInThisPage"
    [appInputQueryMapping]="page.appInputQueryMapping"
    [response]="response"
    [queryId] = "queryId"
    [depth]="depth"
    (sendAppTypesBackToNIEOS)="receiveOpenAppsInThisPage( $event )">

  </app-data-assignment>


<ngx-spinner
  bdColor = "rgba(51, 51, 51, 0.8)"
  size = "large"
  color = "#fff"
  type = "cube-transition"
></ngx-spinner>

<!--    <div *ngIf="grapesJSActivated" id="grapesJSViewer" style="z-index: -1; position: absolute; "></div>-->



      <div style="margin-top: 20px; vertical-align: bottom; ">
        <button type="button" mat-button  matTooltip='{{ createTooltip() }}' (click)="openPageMenu()" *ngIf="!preview" #tooltip="matTooltip">
<!--          (click)="drawer.toggle()"-->
          <img [src]="'../../../../assets/img/logo_transparent.png'" style="width: 40px; margin-bottom: 2px;">
<!--          <span *ngIf="showNote && pageAsDemo"  > &#8592; Click here for inseri tutorials and the inseri App Menu</span>-->
        </button>
        <a href="dashboard#top" *ngIf=" (!pageAsDemo) && !preview" style="color: #4cae4c !important"><mat-icon matTooltip="back to dashboard">home</mat-icon></a>
        <a href="{{'page-set?actionID=' + route.snapshot.queryParams.actionID}}" *ngIf="route.snapshot.queryParams.page" style="color: #4cae4c !important; margin-left: 15px;"><mat-icon matTooltip="back to pageSet">filter_none</mat-icon></a>
        <mat-chip-list *ngFor="let page of pagesOfThisActtion; let i = index;" style=" margin-left: 15px; display: inline-block;">
          <mat-chip matTooltip="{{ page.description }}" selected [color]="'primary'"  *ngIf="checkIfSelected( i )">
            {{ page.title }}
          </mat-chip>
          <mat-chip matTooltip="{{ page.description }}" *ngIf="!checkIfSelected( i )" (click)="selectPage( i, page )">
            {{ page.title }}
          </mat-chip>
        </mat-chip-list>
        <a *ngIf=" (!pageAsDemo) && !preview" matTooltip='Preview of published page' style="margin-left: 15px; float: right; margin-right: 15px;" (click)="preview = !preview" ><mat-icon>nature_people</mat-icon></a>
        <a *ngIf=" (!pageAsDemo) && preview" matTooltip='Back to page editor' style="color: #4cae4c !important;  margin-left: 15px; float: right; margin-right: 15px;" (click)="preview = !preview" ><mat-icon>nature</mat-icon></a>
        <button *ngIf="preview" mat-button style="float: right">Page Publish options</button>
<div>

    <!-- Data Chooser -->
  <div style=" position: fixed; bottom: 0; right: 0; z-index: 200; overflow-x: auto; margin-top: 70px;"
       *ngIf="openAppsInThisPage[ 'dataChooser' ].model.length > 0">
    <mat-expansion-panel style="float: right; width: 300px;">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Queries
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div *ngFor="let dataChooser of openAppsInThisPage[ 'dataChooser' ].model; let i = index;" >
        <div *ngIf="generateQueryAppPathInformation( openAppsInThisPage[ 'dataChooser' ].model[i].queryId ) !== undefined" >
          <button
            *ngIf="openAppsInThisPage[ 'dataChooser' ].model[i].title.search( 'Depth: ' ) === -1 "
            (click)="openQueryInformationDialog( openAppsInThisPage[ 'dataChooser' ].model[i].queryId )"
            mat-button matTooltip="{{openAppsInThisPage[ 'dataChooser' ].model[i].title}}" >
            {{ 'Query ' + i }}
          </button> <br>
          <app-data-chooser
            [appInputQueryMapping]=" page.appInputQueryMapping"
            [response]="openAppsInThisPage[ 'dataChooser' ].model[i].response"
            [queryId] = "openAppsInThisPage[ 'dataChooser' ].model[i].queryId"
            [openAppsInThisPage] = "openAppsInThisPage"
            [dataChooserEntries]="openAppsInThisPage[ 'dataChooser' ].model[i].dataChooserEntries"
            [description]=" openAppsInThisPage[ 'dataChooser' ].model[i].depth "
            [depth]="openAppsInThisPage[ 'dataChooser' ].model[i].depth"
            (sendIndexBack)="updateMainResourceIndex( $event )">
          </app-data-chooser>
        </div>
      </div>
    </mat-expansion-panel>
  </div>
  </div>

      <!-- Image Viewer -->
      <div *ngFor="let imageViewer of openAppsInThisPage[ 'imageViewer' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>image</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="imageViewer.appear()">Show Image Viewer {{ i }}</button>
            <button mat-menu-item >Choose Image</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'imageViewer' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #imageViewer
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'imageViewer' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'imageViewer' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'imageViewer' ].model[i].hash"
               [title]="openAppsInThisPage[ 'imageViewer' ].model[i].title || 'Image Viewer ' + i "
               [type]="openAppsInThisPage[ 'imageViewer' ].type"
               [firstPopupX]="openAppsInThisPage[ 'imageViewer' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'imageViewer' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'imageViewer' ].model[i].width, '500' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'imageViewer' ].model[i].height, '700')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'imageViewer' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'imageViewer' ].model[i].height, '700' ) + 'px',
  'width': openAppsInThisPage[ 'imageViewer' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'imageViewer' ].model[i].width, '500' ) + 'px'}">
          <app-image-with-overlay style="position: sticky;"
                                  [iiifImagePath]="openAppsInThisPage[ 'imageViewer' ].model[i][ 'fileValueAsUrl' ]"
                                  [maxImageWidth]="openAppsInThisPage[ 'imageViewer' ].model[i][ 'stillImageFileValueHasDimX' ]"
                                  [maxImageHeight]="openAppsInThisPage[ 'imageViewer' ].model[i][ 'stillImageFileValueHasDimY' ]"
                                  width="500"
                                  height="700">
          </app-image-with-overlay>
          </div>
        </popup>
      </div>

    <!-- Simple Image App -->
    <div *ngFor="let image of openAppsInThisPage[ 'simpleImageApp' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>add_photo_alternate</mat-icon> {{ i }} </button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="simpleImageApp.appear()" >Show Image Viewer {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'simpleImageApp' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #simpleImageApp
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'simpleImageApp' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'simpleImageApp' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'simpleImageApp' ].model[i].hash"
             [title]="openAppsInThisPage[ 'simpleImageApp' ].model[i].title || 'Image' + i"
             [type]="openAppsInThisPage[ 'simpleImageApp' ].type"
             [firstPopupX]="openAppsInThisPage[ 'simpleImageApp' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'simpleImageApp' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'simpleImageApp' ].model[i].width, '500' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'simpleImageApp' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'simpleImageApp' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'simpleImageApp' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'simpleImageApp' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'simpleImageApp' ].model[i].width, '500' ) + 'px'}">
        <app-simple-image-app
          style="position: sticky;"
          [imageURL]="openAppsInThisPage[ 'simpleImageApp' ].model[i]['imageURL']">

        </app-simple-image-app>
        </div>
      </popup>
    </div>

<div ng-bind-html="variable | emoticons:{linkTarget:'_blank'}"></div>

    <!-- Login -->
    <div *ngFor="let image of openAppsInThisPage[ 'login' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>lock_open</mat-icon> {{ i }} </button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="login.appear()" >Show Inseri Login {{ i }}</button>
        </mat-menu>
      </div>
      <popup #login
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'login' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'login' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'login' ].model[i].hash"
             [title]=" '&#8592; Minimize me &nbsp; &#9752; I am an Inseri App, drag me around &nbsp; &#9752; View my settings &#8594; '"
             [type]="openAppsInThisPage[ 'login' ].type"
             [firstPopupX]="openAppsInThisPage[ 'login' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'login' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'login' ].model[i].width, '1200' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'login' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'login' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'login' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'login' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'login' ].model[i].width, '1200' ) + 'px'}">
          <app-home></app-home>
        </div>
      </popup>
    </div>

      <!-- TextViewer -->
      <div *ngFor="let textViewer of openAppsInThisPage[ 'textViewer' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>short_text</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="textViewer.appear()" >Show Text Viewer {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'textViewer' ].model, i ) ">Remove this app</button>
            <button mat-menu-item>Choose Text</button>
          </mat-menu>
        </div>
        <popup #textViewer
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'textViewer' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'textViewer' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'textViewer' ].model[i].hash"
               [title]="openAppsInThisPage[ 'textViewer' ].model[i].title || 'Text Viewer ' + i"
               [type]="openAppsInThisPage[ 'textViewer' ].type"
               [firstPopupX]="openAppsInThisPage[ 'textViewer' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'textViewer' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'textViewer' ].model[i].width, '500' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'textViewer' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'textViewer' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'textViewer' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'textViewer' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'textViewer' ].model[i].width, '500' ) + 'px'}">
            <app-text-view class="draggable" style="position: sticky;">
            </app-text-view>
          </div>
        </popup>
      </div>

    <!-- HTML viewer -->
    <div *ngFor="let htmlViewer of openAppsInThisPage[ 'htmlViewer' ].model; let i = index;" >
      <popup #htmlViewer
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'htmlViewer' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'htmlViewer' ].model[i].fullHeight"
             [hash]="openAppsInThisPage[ 'htmlViewer' ].model[i].hash"
             [title]="openAppsInThisPage[ 'htmlViewer' ].model[i].title || 'HTML Viewer ' + i"
             [type]="openAppsInThisPage[ 'htmlViewer' ].type"
             [firstPopupX]="openAppsInThisPage[ 'htmlViewer' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'htmlViewer' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'htmlViewer' ].model[i].width, '500' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'htmlViewer' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'htmlViewer' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'htmlViewer' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'htmlViewer' ].model[i].fullWidth ? '100%' : openAppsInThisPage[ 'htmlViewer' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'htmlViewer' ].model[i].width, '500' ) + 'px'}">
          <app-html-viewer class="draggable" style="position: sticky;"
                           [htmlContent]="openAppsInThisPage[ 'htmlViewer' ].model[i]['htmlContent']"
                           [selectiveStyleDeclarations]="openAppsInThisPage[ 'htmlViewer' ].model[i]['selectiveStyleDeclarations']"
                           [styleDeclarations]="openAppsInThisPage[ 'htmlViewer' ].model[i]['styleDeclarations']">
          </app-html-viewer>
        </div>
      </popup>
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>aspect_ratio</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="htmlViewer.appear()" >Show HTML Viewer {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'htmlViewer' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
    </div>

      <!-- Synopsis -->
      <div *ngFor="let synopsisViewer of openAppsInThisPage[ 'synopsisViewer' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>art_track</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="synopsisViewer.appear()" >Show Synopsis Viewer {{ i }}</button><br>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'synopsisViewer' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #synopsisViewer
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'synopsisViewer' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'synopsisViewer' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'synopsisViewer' ].model[i].hash"
               [title]="openAppsInThisPage[ 'synopsisViewer' ].model[i].title || 'Synopsis Viewer ' + i"
               [type]="openAppsInThisPage[ 'synopsisViewer' ].type"
               [firstPopupX]="openAppsInThisPage[ 'synopsisViewer' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'synopsisViewer' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'synopsisViewer' ].model[i].width, '900' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'synopsisViewer' ].model[i].height, '400')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'synopsisViewer' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'synopsisViewer' ].model[i].height, '150' ) + 'px',
  'width': openAppsInThisPage[ 'synopsisViewer' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'synopsisViewer' ].model[i].width, '250' ) + 'px'}">
            <app-synopsis style="position: sticky;">

            </app-synopsis>
          </div>
        </popup>
      </div>

      <!-- Resource Creation Form -->
      <div *ngFor="let createResourceForm of openAppsInThisPage[ 'createResourceForm' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>add_to_queue</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="createResourceForm.appear()" >Show Create Resource Form {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'createResourceForm' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #createResourceForm
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'createResourceForm' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'createResourceForm' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'createResourceForm' ].model[i].hash"
               [title]="openAppsInThisPage[ 'createResourceForm' ].model[i].title ||  'Resource Creation ' + i"
               [type]="openAppsInThisPage[ 'createResourceForm' ].type"
               [firstPopupX]="openAppsInThisPage[ 'createResourceForm' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'createResourceForm' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'createResourceForm' ].model[i].width, '900' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'createResourceForm' ].model[i].height, '400')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'createResourceForm' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'createResourceForm' ].model[i].height, '400' ) + 'px',
  'width': openAppsInThisPage[ 'createResourceForm' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'createResourceForm' ].model[i].width, '900' ) + 'px'}" >
            <app-create-resource style="position: sticky;"
                                 [projectIRI]="projectIRI"
                                 (resourceIRI)="closeApp( openAppsInThisPage[ 'createResourceForm' ].model, i )">
            </app-create-resource>
          </div>
        </popup>
      </div>

    <!-- Edit Resource Form -->
    <div *ngFor="let editResourceForm of openAppsInThisPage[ 'editResourceForm' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>web</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="editResourceForm.appear()" >Show Create Resource Form {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'editResourceForm' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #editResourceForm
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'editResourceForm' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'editResourceForm' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'editResourceForm' ].model[i].hash"
             [title]="openAppsInThisPage[ 'editResourceForm' ].model[i].title ||  'Edit Resource ' + i"
             [type]="openAppsInThisPage[ 'editResourceForm' ].type"
             [firstPopupX]="openAppsInThisPage[ 'editResourceForm' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'editResourceForm' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'editResourceForm' ].model[i].width, '900' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'editResourceForm' ].model[i].height, '400')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'editResourceForm' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'editResourceForm' ].model[i].height, '400' ) + 'px',
  'width': openAppsInThisPage[ 'editResourceForm' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'editResourceForm' ].model[i].width, '900' ) + 'px'}" >
          <app-resource-form (resourceIsDeleted)="closeApp( openAppsInThisPage[ 'createResourceForm' ].model, i )">
          </app-resource-form>
        </div>
      </popup>
    </div>


    <!-- textlistViewers -->
      <div *ngFor="let createResourceForm of openAppsInThisPage[ 'textlistViewers' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>short_text</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="textlistViewers.appear()" >Show Plaintext Viewer {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'textlistViewers' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #textlistViewers
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'textlistViewers' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'textlistViewers' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'textlistViewers' ].model[i].hash"
               [title]="openAppsInThisPage[ 'textlistViewers' ].model[i].title || 'Plaintext - Viewer ' + i"
               [type]="openAppsInThisPage[ 'textlistViewers' ].type"
               [firstPopupX]="openAppsInThisPage[ 'textlistViewers' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'textlistViewers' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'textlistViewers' ].model[i].width, '250' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'textlistViewers' ].model[i].height, '150')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'textlistViewers' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'textlistViewers' ].model[i].height, '150' ) + 'px',
        'width': openAppsInThisPage[ 'textlistViewers' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'textlistViewers' ].model[i].width, '250' ) + 'px'}">
            <app-textlist-viewer style="position: sticky;"
                                 [textToDisplay]="openAppsInThisPage[ 'textlistViewers' ].model[i]['textlist']">
            </app-textlist-viewer>
          </div>
        </popup>
      </div>

      <!-- youtubeVideo -->
      <div *ngFor="let createResourceForm of openAppsInThisPage[ 'youtubeVideo' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>video_library</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="youtubeVideo.appear()" >Show Youtube Video Viewer {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'youtubeVideo' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #youtubeVideo
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'youtubeVideo' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'youtubeVideo' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'youtubeVideo' ].model[i].hash"
               [title]="openAppsInThisPage[ 'youtubeVideo' ].model[i].title || 'Youtube Video ' + i"
               [type]="openAppsInThisPage[ 'youtubeVideo' ].type"
               [firstPopupX]="openAppsInThisPage[ 'youtubeVideo' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'youtubeVideo' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'youtubeVideo' ].model[i].width, '600' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'youtubeVideo' ].model[i].height, '400')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'youtubeVideo' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'youtubeVideo' ].model[i].height, '400' ) + 'px',
            'width': openAppsInThisPage[ 'youtubeVideo' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'youtubeVideo' ].model[i].width, '600' ) + 'px'}">
            <app-youtube-video
              [videoURL]="openAppsInThisPage[ 'youtubeVideo' ].model[i]['videoURL']">

            </app-youtube-video>
          </div>
        </popup>
      </div>

    <!-- pageMenu -->
    <div *ngFor="let createResourceForm of openAppsInThisPage[ 'pageMenu' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>settings</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="pageMenu.appear()" >Show Page Menu {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'pageMenu' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #pageMenu
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'pageMenu' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'pageMenu' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'pageMenu' ].model[i].hash"
             [title]="'Inseri Menu ' + i"
             [type]="openAppsInThisPage[ 'pageMenu' ].type"
             [firstPopupX]="openAppsInThisPage[ 'pageMenu' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'pageMenu' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'pageMenu' ].model[i].width, '600' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'pageMenu' ].model[i].height, '600')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'pageMenu' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'pageMenu' ].model[i].height, '600' ) + 'px',
        'width': openAppsInThisPage[ 'pageMenu' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'pageMenu' ].model[i].width, '600' ) + 'px'}">

          <div *ngIf="!pageAsDemo">
            <h4 style="align-content: center" i18n="@@yourPageTitle">Your Page</h4>
            <button mat-button (click)="updatePage()" i18n="@@savePageButton">Save Page</button>
            <button mat-button (click)="expandPanels()" i18n="@@toggleDescriptionButton"> Un/fold description</button><br>
            <button mat-button (click)="openDataManagement()" i18n="@@pageDataManagementLink">Page Data Management</button><br>
            <button mat-button (click)="changeAppFramePosition()" > Order apps by type </button>
          </div>

          <div *ngIf="pageAsDemo">
            <button mat-button color="primary" (click)="addVideoApp( 'https://www.youtube.com/embed/9An1cGPrv9Q' )"> <mat-icon>video_library</mat-icon> Watch Video "First steps in Inseri"</button>
          </div>

          <mat-form-field style="width: 100%">
            <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
          </mat-form-field>

          <div style="width: 100%">
            <table mat-table [dataSource]="dataSource" matSort>

              <!-- ID Column -->
              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Icon </th>
                <td mat-cell *matCellDef="let row" (click)="addAnotherApp(row.appType, true)" style="cursor: pointer; width: 25%;"> <mat-icon>{{row.id}}</mat-icon> </td>
              </ng-container>

              <!-- Tag Column -->
              <ng-container matColumnDef="tags" >
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tags </th>
                <td mat-cell *matCellDef="let row" (click)="addAnotherApp(row.appType, true)" style="cursor: pointer; width: 25%;"> {{row.tags}} </td>
              </ng-container>

              <!-- Name Column -->
              <ng-container matColumnDef="name" >
                <th mat-header-cell *matHeaderCellDef mat-sort-header > Name </th>
                <td mat-cell *matCellDef="let row"
                    (click)="addAnotherApp(row.appType, true)"
                    style="cursor: pointer; width: 25%;" > {{row.name}} </td>
              </ng-container>

              <!-- Color Column -->
              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                <td mat-cell *matCellDef="let row" [style.color]="row.color" (click)="addAnotherApp(row.appType, true)" style="cursor: pointer; width: 25%;" matTooltip="{{row.description}}"> {{row.status}} </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns" style="width: 100%;"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;" style="width: 100%;">
              </tr>
            </table>

            <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
          </div>
        </div>
      </popup>
    </div>

    <!-- parzivalFassung -->
    <div *ngFor="let parzivalFassung of openAppsInThisPage[ 'parzivalFassung' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>view_week</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="parzivalFassung.appear()" >Show Parzival Fassungs App {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'parzivalFassung' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #parzivalFassung
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'parzivalFassung' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'parzivalFassung' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'parzivalFassung' ].model[i].hash"
             [title]="openAppsInThisPage[ 'parzivalFassung' ].model[i].title || 'parzivalFassung ' + i"
             [type]="openAppsInThisPage[ 'parzivalFassung' ].type"
             [firstPopupX]="openAppsInThisPage[ 'parzivalFassung' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'parzivalFassung' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'parzivalFassung' ].model[i].width, '350' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'parzivalFassung' ].model[i].height, '250')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'parzivalFassung' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'parzivalFassung' ].model[i].height, '250' ) + 'px',
        'width': openAppsInThisPage[ 'parzivalFassung' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'parzivalFassung' ].model[i].width, '350' ) + 'px'}">
          <app-parzival-fassung style="position: sticky;"
                                [textJson]="openAppsInThisPage[ 'parzivalFassung' ].model[i]['textJson']">
          </app-parzival-fassung>
        </div>
      </popup>
    </div>

    <!-- avp-Edition -->
    <div *ngFor="let avpEditionView of openAppsInThisPage[ 'avpEditionView' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>turned_in</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="avpEditionView.appear()" >Show AVP Edition Viewer {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'avpEditionView' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #avpEditionView
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'avpEditionView' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'avpEditionView' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'avpEditionView' ].model[i].hash"
             [title]="openAppsInThisPage[ 'avpEditionView' ].model[i].title || 'avpEditionView ' + i"
             [type]="openAppsInThisPage[ 'avpEditionView' ].type"
             [firstPopupX]="openAppsInThisPage[ 'avpEditionView' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'avpEditionView' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'avpEditionView' ].model[i].width, '350' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'avpEditionView' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'avpEditionView' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'avpEditionView' ].model[i].height, '500' ) + 'px',
        'width': openAppsInThisPage[ 'avpEditionView' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'avpEditionView' ].model[i].width, '350' ) + 'px'}">
          <app-p0041-edition style="position: sticky;"
                             [backendAddress]="openAppsInThisPage[ 'avpEditionView' ].model[i][ 'backendAddress' ]">
          </app-p0041-edition>
        </div>
      </popup>
    </div>

    <!-- openbis Login -->
    <div *ngFor="let openbisLogin of openAppsInThisPage[ 'openbisLogin' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>album</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="openbisLogin.appear()" >Show OpenBis Login {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'openbisLogin' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #openbisLogin
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'openbisLogin' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'openbisLogin' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'openbisLogin' ].model[i].hash"
             [title]="openAppsInThisPage[ 'openbisLogin' ].model[i].title || 'openbisLogin ' + i"
             [type]="openAppsInThisPage[ 'openbisLogin' ].type"
             [firstPopupX]="openAppsInThisPage[ 'openbisLogin' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'openbisLogin' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'openbisLogin' ].model[i].width, '500' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'openbisLogin' ].model[i].height, '350')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'openbisLogin' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'openbisLogin' ].model[i].height, '350' ) + 'px',
        'width': openAppsInThisPage[ 'openbisLogin' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'openbisLogin' ].model[i].width, '500' ) + 'px'}">
          <app-openbis-login>

          </app-openbis-login>
        </div>
      </popup>
    </div>

    <!-- svg-Transcription -->
    <div *ngFor="let svgTranscription of openAppsInThisPage[ 'svgTranscription' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>line_style</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="svgTranscription.appear()" >Show AVP Edition Viewer {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'svgTranscription' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #svgTranscription
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'svgTranscription' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'svgTranscription' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'svgTranscription' ].model[i].hash"
             [title]="openAppsInThisPage[ 'svgTranscription' ].model[i].title || 'svgTranscription ' + i"
             [type]="openAppsInThisPage[ 'svgTranscription' ].type"
             [firstPopupX]="openAppsInThisPage[ 'svgTranscription' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'svgTranscription' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'svgTranscription' ].model[i].width, '350' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'svgTranscription' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'svgTranscription' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'svgTranscription' ].model[i].height, '500' ) + 'px',
        'width': openAppsInThisPage[ 'svgTranscription' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'svgTranscription' ].model[i].width, '350' ) + 'px'}">
          <app-text-svg-view-wrapper style="position: sticky;"
                                         [pageTree]="openAppsInThisPage['svgTranscription'].model[i]['pageTree']"
                                         [imageUrl]="openAppsInThisPage['svgTranscription'].model[i]['imageUrl']"
                                         [width]="openAppsInThisPage['svgTranscription'].model[i]['imageWidth']"
                                         [height]="openAppsInThisPage['svgTranscription'].model[i]['imageHeight']" >
          </app-text-svg-view-wrapper>
        </div>
      </popup>
    </div>

    <!-- jsonViewer -->
    <div *ngFor="let jsonViewer of openAppsInThisPage[ 'jsonViewer' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>spa</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="jsonViewer.appear()" >Show Json Viewer {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'jsonViewer' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #jsonViewer
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'jsonViewer' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'jsonViewer' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'jsonViewer' ].model[i].hash"
             [title]="openAppsInThisPage[ 'jsonViewer' ].model[i].title || 'Json - Viewer ' + i"
             [type]="openAppsInThisPage[ 'jsonViewer' ].type"
             [firstPopupX]="openAppsInThisPage[ 'jsonViewer' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'jsonViewer' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'jsonViewer' ].model[i].width, '500' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'jsonViewer' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'jsonViewer' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'jsonViewer' ].model[i].height, '500' ) + 'px',
        'width': openAppsInThisPage[ 'jsonViewer' ].model[i].fullWidth ? '100%' :  produceHeightAndWidth( openAppsInThisPage[ 'jsonViewer' ].model[i].width, '500' ) + 'px'}">
          <response-tree style="position: sticky;"
                               [queryResponse]="openAppsInThisPage[ 'jsonViewer' ].model[i]['json']">
          </response-tree>
        </div>
      </popup>
    </div>

    <!-- Tree navigation -->
    <div *ngFor="let treeNavigation of openAppsInThisPage[ 'treeNavigation' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>subdirectory_arrow_right</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" *ngIf="!preview">
          <button mat-menu-item (click)="treeNavigation.appear()" >Show Tree Navigation {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'treeNavigation' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #treeNavigation
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'treeNavigation' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'treeNavigation' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'treeNavigation' ].model[i].hash"
             [title]="openAppsInThisPage[ 'treeNavigation' ].model[i].title ||  'Tree navigation ' + i"
             [type]="openAppsInThisPage[ 'treeNavigation' ].type"
             [firstPopupX]="openAppsInThisPage[ 'treeNavigation' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'treeNavigation' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'treeNavigation' ].model[i].width, '400' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'treeNavigation' ].model[i].height, '600')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'treeNavigation' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'treeNavigation' ].model[i].height, '600' ) + 'px',
  'width': openAppsInThisPage[ 'treeNavigation' ].model[i].fullWidth ? '100%' :  produceHeightAndWidth( openAppsInThisPage[ 'treeNavigation' ].model[i].width, '400' ) + 'px'}" >
          <app-navigation-tree [queryResponse]="openAppsInThisPage[ 'treeNavigation' ].model[i]['json']">
          </app-navigation-tree>
        </div>
      </popup>
    </div>

    <!-- Result list -->
    <div *ngFor="let dataListView of openAppsInThisPage[ 'dataListView' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>view_list</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="dataListView.appear()" >Show Data list Viewer {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'dataListView' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #dataListView
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'dataListView' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'dataListView' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'dataListView' ].model[i].hash"
             [title]="openAppsInThisPage[ 'dataListView' ].model[i].title || 'Data list viewer' + i"
             [type]="openAppsInThisPage[ 'dataListView' ].type"
             [firstPopupX]="openAppsInThisPage[ 'dataListView' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'dataListView' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'dataListView' ].model[i].width, '700' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'dataListView' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'dataListView' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'dataListView' ].model[i].height, '500' ) + 'px',
        'width': openAppsInThisPage[ 'dataListView' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'dataListView' ].model[i].width, '700' ) + 'px'}">
          <data-list-view style="position: sticky;"
                         [queryResponse]="openAppsInThisPage[ 'dataListView' ].model[i]['json']"
                          [dataListSettings]="openAppsInThisPage[ 'dataListView' ].model[i]['settings']">
          </data-list-view>
        </div>
      </popup>
    </div>

      <!-- Bar Charts -->
      <div *ngFor="let barChart of openAppsInThisPage[ 'barCharts' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>bar_chart</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="barChart.appear()" (click)="openAppsInThisPage[ 'barCharts' ].model[i].initialized = true">Show Bar Chart {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'barCharts' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #barChart
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'barCharts' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'barCharts' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'barCharts' ].model[i].hash"
               [title]="openAppsInThisPage[ 'barCharts' ].model[i].title || 'Bar Chart ' + i"
               [type]="openAppsInThisPage[ 'barCharts' ].type"
               [firstPopupX]="openAppsInThisPage[ 'barCharts' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'barCharts' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'barCharts' ].model[i].width, '1200' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'barCharts' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'barCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'barCharts' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'barCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'barCharts' ].model[i].width, '1200' ) + 'px'}">
            <app-bar-chart
              [initialised] = "openAppsInThisPage[ 'barCharts' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >

            </app-bar-chart>
          </div>
        </popup>
      </div>

    <!-- Spiral Bar Charts -->
    <div *ngFor="let barChart of openAppsInThisPage[ 'spiralBarCharts' ].model; let i = index;" >
      <div *ngIf="!preview">
        <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>bar_chart</mat-icon> {{ i }}</button>
        <mat-menu #menu="matMenu" >
          <button mat-menu-item (click)="spiralBarCharts.appear()" (click)="openAppsInThisPage[ 'spiralBarCharts' ].model[i].initialized = true">Show Spiral Bar Chart {{ i }}</button>
          <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'spiralBarCharts' ].model, i ) ">Remove this app</button>
        </mat-menu>
      </div>
      <popup #spiralBarCharts
             [preview]="preview"
             [fullWidth]="openAppsInThisPage[ 'spiralBarCharts' ].model[i].fullWidth"
             [fullHeight]="openAppsInThisPage[ 'spiralBarCharts' ].model[i].fullHeight"
             (sendTiledPositionBack) = "updateTiledPosition( $event )"
             [position]="appFramePosition"
             [hash]="openAppsInThisPage[ 'spiralBarCharts' ].model[i].hash"
             [title]="openAppsInThisPage[ 'spiralBarCharts' ].model[i].title || 'Spiral Bar Chart ' + i"
             [type]="openAppsInThisPage[ 'spiralBarCharts' ].type"
             [firstPopupX]="openAppsInThisPage[ 'spiralBarCharts' ].model[i].x"
             [firstPopupY]="openAppsInThisPage[ 'spiralBarCharts' ].model[i].y"
             [width]="produceHeightAndWidth( openAppsInThisPage[ 'spiralBarCharts' ].model[i].width, '500' )"
             [height]="produceHeightAndWidth( openAppsInThisPage[ 'spiralBarCharts' ].model[i].height, '500')"
             (sendAppCoordinatesBack)="updateAppCoordinates($event)"
             (sendAppSettingsBack)="updateAppSettings($event)">
        <div [ngStyle]="{'height': openAppsInThisPage[ 'spiralBarCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'spiralBarCharts' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'spiralBarCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'spiralBarCharts' ].model[i].width, '500' ) + 'px'}">
          <app-spiral-bar-chart
            [initialised] = "openAppsInThisPage[ 'spiralBarCharts' ].model[i].initialized"
            [numberOfInitialisedComponent] = " i " >

          </app-spiral-bar-chart>
        </div>
      </popup>
    </div>


      <!-- Line Charts -->
      <div *ngFor="let lineChart of openAppsInThisPage[ 'lineCharts' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>show_chart</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="lineChart.appear()" (click)="openAppsInThisPage[ 'lineCharts' ].model[i].initialized = true">Show Line Chart {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'lineCharts' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #lineChart
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'lineCharts' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'lineCharts' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'lineCharts' ].model[i].hash"
               [title]="openAppsInThisPage[ 'lineCharts' ].model[i].title || 'Line Chart ' + i"
               [type]="openAppsInThisPage[ 'lineCharts' ].type"
               [firstPopupX]="openAppsInThisPage[ 'lineCharts' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'lineCharts' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'lineCharts' ].model[i].width, '600' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'lineCharts' ].model[i].height, '400')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'lineCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'lineCharts' ].model[i].height, '400' ) + 'px',
  'width': openAppsInThisPage[ 'lineCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'lineCharts' ].model[i].width, '600' ) + 'px'}">
            <app-multi-line-chart
              [initialised] = "openAppsInThisPage[ 'lineCharts' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >

            </app-multi-line-chart>
          </div>
        </popup>
      </div>

      <!-- Brush Zoom Charts -->
      <div *ngFor="let brushZoomChart of openAppsInThisPage[ 'brushZoomCharts' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>insert_chart_outlined</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="brushZoomChart.appear()" (click)="openAppsInThisPage[ 'brushZoomCharts' ].model[i].initialized = true">Show Brush Zoom Chart {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'brushZoomCharts' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #brushZoomChart
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'brushZoomCharts' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'brushZoomCharts' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'brushZoomCharts' ].model[i].hash"
               [title]="openAppsInThisPage[ 'brushZoomCharts' ].model[i].title || 'Brush Zoom Chart ' + i"
               [type]="openAppsInThisPage[ 'brushZoomCharts' ].type"
               [firstPopupX]="openAppsInThisPage[ 'brushZoomCharts' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'brushZoomCharts' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'brushZoomCharts' ].model[i].width, '900' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'brushZoomCharts' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'brushZoomCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'brushZoomCharts' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'brushZoomCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'brushZoomCharts' ].model[i].width, '900' ) + 'px'}">
            <app-brush-and-zoom
              [initialised] = "openAppsInThisPage[ 'brushZoomCharts' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >

            </app-brush-and-zoom>
          </div>
        </popup>
      </div>

      <!-- Leaflet Map -->
      <div *ngFor="let leafletMap of openAppsInThisPage[ 'leafletMaps' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>add_location</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="leafletMap.appear()" (click)="openAppsInThisPage[ 'leafletMaps' ].model[i].initialized = true">Show Leaflet Map {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'leafletMaps' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #leafletMap
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'leafletMaps' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'leafletMaps' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'leafletMaps' ].model[i].hash"
               [title]="openAppsInThisPage[ 'leafletMaps' ].model[i].title ||  'Leaflet Map ' + i"
               [type]="openAppsInThisPage[ 'leafletMaps' ].type"
               [firstPopupX]="openAppsInThisPage[ 'leafletMaps' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'leafletMaps' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'leafletMaps' ].model[i].width, '500' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'leafletMaps' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'leafletMaps' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'leafletMaps' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'leafletMaps' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'leafletMaps' ].model[i].width, '500' ) + 'px'}">
            <app-leaflet-example
              [initialised] = "openAppsInThisPage[ 'leafletMaps' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >

            </app-leaflet-example>
          </div>
        </popup>
      </div>

      <!-- Pie Chart -->
      <div *ngFor="let pieChart of openAppsInThisPage[ 'pieCharts' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>pie_chart</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="pieChart.appear()" (click)="openAppsInThisPage[ 'pieCharts' ].model[i].initialized = true">Show Pie Chart {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'pieCharts' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #pieChart
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'pieCharts' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'pieCharts' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'pieCharts' ].model[i].hash"
               [title]="openAppsInThisPage[ 'pieCharts' ].model[i].title || 'Pie Chart ' + i"
               [type]="openAppsInThisPage[ 'pieCharts' ].type"
               [firstPopupX]="openAppsInThisPage[ 'pieCharts' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'pieCharts' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'pieCharts' ].model[i].width, '700' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'pieCharts' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'pieCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'pieCharts' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'pieCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'pieCharts' ].model[i].width, '700' ) + 'px'}">
            <app-pie-chart
              [initialised] = "openAppsInThisPage[ 'pieCharts' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >
            </app-pie-chart>
          </div>
        </popup>
      </div>

      <!-- Radial Bar Chart -->
      <div *ngFor="let radialBarChart of openAppsInThisPage[ 'radialBarCharts' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>multiline_chart</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="radialBarChart.appear()" (click)="openAppsInThisPage[ 'radialBarCharts' ].model[i].initialized = true">Show Radial Bar Chart {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'radialBarCharts' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #radialBarChart
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'radialBarCharts' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'radialBarCharts' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'radialBarCharts' ].model[i].hash"
               [title]="openAppsInThisPage[ 'radialBarCharts' ].model[i].title || 'Radial Bar Chart ' + i"
               [type]="openAppsInThisPage[ 'radialBarCharts' ].type"
               [firstPopupX]="openAppsInThisPage[ 'radialBarCharts' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'radialBarCharts' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'radialBarCharts' ].model[i].width, '500' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'radialBarCharts' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'radialBarCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'radialBarCharts' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'radialBarCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'radialBarCharts' ].model[i].width, '500' ) + 'px'}">
            <app-radial-barchart
              [initialised] = "openAppsInThisPage[ 'radialBarCharts' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >
            </app-radial-barchart>
          </div>
        </popup>
      </div>

      <!-- Sankey Chart -->
      <div *ngFor="let sankeyChart of openAppsInThisPage[ 'sankeyCharts' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>linear_scale</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="sankeyChart.appear()" (click)="openAppsInThisPage[ 'sankeyCharts' ].model[i].initialized = true">Sankey Chart {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'sankeyCharts' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #sankeyChart
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'sankeyCharts' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'sankeyCharts' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'sankeyCharts' ].model[i].title || openAppsInThisPage[ 'sankeyCharts' ].model[i].hash"
               [title]="'Sankey Chart ' + i"
               [type]="openAppsInThisPage[ 'sankeyCharts' ].type"
               [firstPopupX]="openAppsInThisPage[ 'sankeyCharts' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'sankeyCharts' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'sankeyCharts' ].model[i].width, '900' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'sankeyCharts' ].model[i].height, '150')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'sankeyCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'sankeyCharts' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'sankeyCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'sankeyCharts' ].model[i].width, '900' ) + 'px'}">
            <app-sankey
              [initialised] = "openAppsInThisPage[ 'sankeyCharts' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >
            </app-sankey>
          </div>
        </popup>
      </div>

      <!-- Stacked Bar Chart -->
      <div *ngFor="let stackedBarChart of openAppsInThisPage[ 'stackedBarCharts' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>subtitles</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="stackedBarChart.appear()" (click)="openAppsInThisPage[ 'stackedBarCharts' ].model[i].initialized = true">Stacked Bar Chart {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'stackedBarCharts' ].model, i ) ">Remove this app</button>
          </mat-menu>
        </div>
        <popup #stackedBarChart
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'stackedBarCharts' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'stackedBarCharts' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'stackedBarCharts' ].model[i].hash"
               [title]="openAppsInThisPage[ 'stackedBarCharts' ].model[i].title ||  'Sankey Chart ' + i"
               [type]="openAppsInThisPage[ 'stackedBarCharts' ].type"
               [firstPopupX]="openAppsInThisPage[ 'stackedBarCharts' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'stackedBarCharts' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'stackedBarCharts' ].model[i].width, '800' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'stackedBarCharts' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'stackedBarCharts' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'stackedBarCharts' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'stackedBarCharts' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'stackedBarCharts' ].model[i].width, '800' ) + 'px'}">
            <app-stacked-bar-chart
              [initialised] = "openAppsInThisPage[ 'stackedBarCharts' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >
            </app-stacked-bar-chart>
          </div>
        </popup>
      </div>

      <!-- Chord diagram -->
      <div *ngFor="let chordDiagram of openAppsInThisPage[ 'chordDiagrams' ].model; let i = index;" >
        <div *ngIf="!preview">
          <button mat-button [matMenuTriggerFor]="menu" style="vertical-align: bottom;" ><mat-icon>all_out</mat-icon> {{ i }}</button>
          <mat-menu #menu="matMenu" >
            <button mat-menu-item (click)="chordDiagram.appear()" (click)="openAppsInThisPage[ 'chordDiagrams' ].model[i].initialized = true">Chord Diagram {{ i }}</button>
            <button mat-menu-item (click)=" closeApp( openAppsInThisPage[ 'chordDiagrams' ].model, i ) ">Close this app</button>
          </mat-menu>
        </div>
        <popup #chordDiagram
               [preview]="preview"
               [fullWidth]="openAppsInThisPage[ 'chordDiagrams' ].model[i].fullWidth"
               [fullHeight]="openAppsInThisPage[ 'chordDiagrams' ].model[i].fullHeight"
               (sendTiledPositionBack) = "updateTiledPosition( $event )"
               [position]="appFramePosition"
               [hash]="openAppsInThisPage[ 'chordDiagrams' ].model[i].hash"
               [title]="openAppsInThisPage[ 'chordDiagrams' ].model[i].title || 'Chord Diagram ' + i"
               [type]="openAppsInThisPage[ 'chordDiagrams' ].type"
               [firstPopupX]="openAppsInThisPage[ 'chordDiagrams' ].model[i].x"
               [firstPopupY]="openAppsInThisPage[ 'chordDiagrams' ].model[i].y"
               [width]="produceHeightAndWidth( openAppsInThisPage[ 'chordDiagrams' ].model[i].width, '600' )"
               [height]="produceHeightAndWidth( openAppsInThisPage[ 'chordDiagrams' ].model[i].height, '500')"
               (sendAppCoordinatesBack)="updateAppCoordinates($event)"
               (sendAppSettingsBack)="updateAppSettings($event)">
          <div [ngStyle]="{'height': openAppsInThisPage[ 'chordDiagrams' ].model[i].fullHeight ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'chordDiagrams' ].model[i].height, '500' ) + 'px',
  'width': openAppsInThisPage[ 'chordDiagrams' ].model[i].fullWidth ? '100%' : produceHeightAndWidth( openAppsInThisPage[ 'chordDiagrams' ].model[i].width, '600' ) + 'px'}">
            <app-chord-diagram
              [initialised] = "openAppsInThisPage[ 'chordDiagrams' ].model[i].initialized"
              [numberOfInitialisedComponent] = " i " >
            </app-chord-diagram>
          </div>
        </popup>
      </div>
<!--    </div>-->
</div>
